# 华为好，华为美，华为为我增智慧，，，
# 初赛
直接建$T$个二分图，按照特定顺序增广。预计大部分节点95百分位带宽为0，这些节点分类为LOW，对于95百分位带宽不为0的节点，分类为HIGH。

对于HIGH节点，将大于等于95百分位的时刻作为5%的burst时刻，LOW节点burst时刻待定。

对于每个节点设置一个$r(i)$，在这里，HIGH节点$r(i)=1$，LOW节点$r(i)=0$。令每个节点的95百分位带宽为$r(i)\cdot x$，二分法求出最小的$x$。
判断某个x是否合法，可以将时刻按照估计的负载从大到小排序，对于每个时刻，如果这个时刻是节点i的burst时刻则i的流量上限为bandwidth[i]，否则为$r(i)\cdot x$。判断这个时刻客户端是否满流。若不满流，则按照**某个自己定义的规则**将一个非burst且还有burst机会的节点变成burst节点，再判断是否满流，直到满流为止。在这里我采用的规则是，优先选择剩余burst次数多的。如果在这个过程中发现所有节点的burst次数均用光还没有满流，则x不合法，否则合法。

最后可以使用退流的方法微调方案，本质上是一个爬山算法。

# 复赛
写了三个策略，分别在三个branch里面，只有最后乱搞的那个有用。
## 策略1
估计一下哪些不可分割的流是“巨大的”。将这些巨大的流先安排到burst的节点，策略同初赛。

然后可以近似地认为剩下的流可以无限分割，用初赛的方法跑出一个网络流的解。将这些不可分割的流往这个解里面塞，本质上是在拟合网络流的解。

**在正式赛里面超时了！**
## 策略2
依然是拟合网络流的解，也要和策略1一样先去掉巨大的流。

先不安排burst，直接二分。找出每个节点在哪个时刻流量最大，将那个时刻设为burst。以此类推，总共进行$t/20$次。

**在正式赛里面超时了！**
## 策略3
最后一天晚上瞎搞出来的贪心，感谢凸优化大哥分享思路。

1、首先将边缘服务器排序，根据 带宽上限/度数 排序。

2、按照这个顺序依次选定服务器，决定其5%满载时刻。将每个时刻可以流到这个服务器的、并且尚未安排的流，求和。从大到小排序，选前5%的时刻来爆发。

3、将该服务器该时段连接的流从大到小排序，挨个放，直到放满为止，并且修正其余服务器在该时刻的连接需求的总和。

4、现在剩下了一些流。将**所有天的所有流**排序一下从大到小遍历，再选服务器节点放进去，选节点的时候，计算将这个流放到这个节点上，成本会增加多少。优先选择增量最少的那个，如果有多个增量一样，选**剩余容量（即95百分位容量-当且流量）** 最小的那个。

# 变更点的处理
只写策略3的处理方法。总体策略不需要大改，只需要在做之前选择出10个特殊节点即可。选择策略有多种，其中的一个策略是，先将每个时刻的总需求从大到小排序。选择前x个时刻，统计每个服务器在这x个时刻里面总共与多少流量关联。将服务器按照关联的总流量降序排序。选出前10个服务器作为特殊服务器。
